import boto3
import time

# Initialize Textract client
textract = boto3.client('textract')

# Specify the S3 bucket and document name
bucket_name = 'your-s3-bucket-name'
document_name = 'your-document.pdf'

# Start the document text detection
response = textract.start_document_text_detection(
    DocumentLocation={
        'S3Object': {
            'Bucket': bucket_name,
            'Name': document_name
        }
    }
)

# Get the job ID
job_id = response['JobId']
print(f'Started job with ID: {job_id}')

# Wait for the job to complete
while True:
    response = textract.get_document_text_detection(JobId=job_id)
    status = response['JobStatus']
    print(f'Status: {status}')
    
    if status in ['SUCCEEDED', 'FAILED']:
        break
    
    time.sleep(5)  # Wait before checking the job status again

# Process the response
if status == 'SUCCEEDED':
    for item in response['Blocks']:
        if item['BlockType'] == 'LINE':
            print(item['Text'])
